
% Physics Packages
% \usepackage{siunitx} % broken with physics package
\usepackage{physics}
\usepackage{physics2}
\usepackage{physconst}

% Math Packages
\usepackage{mathtools}
\usepackage{amsmath}
% \usepackage{amsthm} (replaced with theorem::ntheorem)
\usepackage{amssymb}
\usepackage{amsfonts}

% ------------------------------------------------------------------------------
%   Enclosures
% ------------------------------------------------------------------------------

\NewDocumentCommand{\xenclose}{D<>{0}mmm}%
{%
    \begin{switch}{#1}%
        \xcase{0}{ \left#2 #4 \right#3 }%
        \xcase{1}{ \bigl#2 #4 \bigr#3 }%
        \xcase{2}{ \Bigl#2 #4 \Bigr#3 }%
        \xcase{3}{ \biggl#2 #4 \biggr#3 }%
        \xcase{4}{ \Biggl#2 #4 \Biggr#3 }%
        \xcase{-1}{ #2 #4 #3 }%
    \end{switch}%
}%

\NewDocumentCommand{\xboxed}{D<>{0}m}%
{%
    \boxed{ \xenclose<#1>{.}{.}{#2} }%
}%

% ~ Named Enclosures ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\NewDocumentCommand{\DeclareNamedEnclosure}{>{\SplitList{,}}m mm}
{
    \newcommand{\DefineThisNamedEnclosure}[1]
    {
        \expandafter\DeclareDocumentCommand\csname x##1\endcsname{D<>{0}m}%
        {%
            \xenclose<####1>{#2}{#3}{####2}%
        }%
    }
    \ProcessList{#1}{\DefineThisNamedEnclosure}
    \let\DefineThisNamedEnclosure\undefined
}

\DeclareNamedEnclosure{p,paren}     {(}{)}
\DeclareNamedEnclosure{b,brack}     {[}{]}
\DeclareNamedEnclosure{s,brace,set} {\{}{\}}
\DeclareNamedEnclosure{g,chev,gen}  {\langle}{\rangle}
\DeclareNamedEnclosure{a,abs}       {\vert}{\vert}
\DeclareNamedEnclosure{n,norm}      {\Vert}{\Vert}
\DeclareNamedEnclosure{  floor}     {\lfloor}{\rfloor}
\DeclareNamedEnclosure{  ceil}      {\lceil}{\rceil}
\DeclareNamedEnclosure{  round}     {\lfloor}{\rceil}

% ~ Interval Enclosure ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\NewDocumentCommand{\xinterval}{D<>{0}mm}%
{%
    \begin{switch}{#2}%
        \xcase{o} { \xenclose<#1>{(}{)}{#3} }%
        \xcase{c} { \xenclose<#1>{[}{]}{#3} }%
        \xcase{oo}{ \xenclose<#1>{(}{)}{#3} }%
        \xcase{cc}{ \xenclose<#1>{[}{]}{#3} }%
        \xcase{oc}{ \xenclose<#1>{(}{]}{#3} }%
        \xcase{co}{ \xenclose<#1>{[}{)}{#3} }%
    \end{switch}%
}%

\NewDocumentCommand{\xio}{D<>{0}m}{ \xinterval<#1>{o}{#2} }
\NewDocumentCommand{\xic}{D<>{0}m}{ \xinterval<#1>{c}{#2} }
\NewDocumentCommand{\xioo}{D<>{0}m}{ \xinterval<#1>{oo}{#2} }
\NewDocumentCommand{\xioc}{D<>{0}m}{ \xinterval<#1>{oc}{#2} }
\NewDocumentCommand{\xico}{D<>{0}m}{ \xinterval<#1>{co}{#2} }
\NewDocumentCommand{\xicc}{D<>{0}m}{ \xinterval<#1>{cc}{#2} }

% ~ Other Enclosures ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\NewDocumentCommand{\xgroup}{D<>{0}om}%
{%
    \IfValueTF{#2}{\csname x#2\endcsname<#1>{#3}}{#3}
}%

% Functions
\NewDocumentCommand{\xf}{D<>{0}O{p}mm}%
{%
    #3\xgroup<#1>[#2]{#4}
}%

% Vectors
\usepackage[g]{esvect}
\NewDocumentCommand{\xv}{m}{ \vv{#1} }

% Matrices
\NewDocumentCommand{\xm}{O{p}m}{ \xgroup[#1]{\begin{matrix}#2\end{matrix}} }

% ------------------------------------------------------------------------------
%   Operators
% ------------------------------------------------------------------------------

\NewDocumentCommand{\pd}{O{}m}{\partial^{#1} #2}

\NewDocumentCommand{\xDeclareMathOperator}{mm}%
{%
    \expandafter\DeclareDocumentCommand\csname #1\endcsname{e{_^}D<>{0}O{p}g}%
    {%
        \operatorname{#2}\IfValueT{##1}{_{##1}}\IfValueT{##2}{^{##2}}%
        \IfValueT{##5}{\xgroup<##3>[##4]{##5}}%
    }%
}%

\xDeclareMathOperator{Obj}{\textnormal{Obj}}
\xDeclareMathOperator{Hom}{\textnormal{Hom}}
\xDeclareMathOperator{Ann}{\textnormal{Ann}}

\xDeclareMathOperator{Ker}{\textnormal{Ker}}
\xDeclareMathOperator{Dom}{\textnormal{Dom}}
\xDeclareMathOperator{CoDom}{\textnormal{CoDom}}
\xDeclareMathOperator{Img}{\textnormal{Im}}

\xDeclareMathOperator{Mat}{\textnormal{Mat}}
\xDeclareMathOperator{GL}{\textnormal{GL}}

\xDeclareMathOperator{Id}{\textnormal{Id}}
