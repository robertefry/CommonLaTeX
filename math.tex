
% Tools
\usepackage{mathtools}
\usepackage{bussproofs}
\usepackage{bussproofs-extra}

% Physics Packages
\usepackage{physics}
\usepackage{physconst}

% Math Packages
\usepackage{mathtools}
\usepackage{amsmath}
% \usepackage{amsthm} (replaced with theorem::ntheorem)
\usepackage{amssymb}
\usepackage{amsfonts}

% ------------------------------------------------------------------------------
%   Math Enclosures
% ------------------------------------------------------------------------------

% Math Enclosures
\NewDocumentCommand{\xenclose}{D<>{}mmm}%
{%
    \begin{switch}{#1}%
        \xcase{}{ \left#2 #4 \right#3 }%
        \xcase{0}{ #2 #4 #3 }%
        \xcase{1}{ \bigl#2 #4 \bigr#3 }%
        \xcase{2}{ \Bigl#2 #4 \Bigr#3 }%
        \xcase{3}{ \biggl#2 #4 \biggr#3 }%
        \xcase{4}{ \Biggl#2 #4 \Biggr#3 }%
    \end{switch}%
}%

% Math Enclosure Groups
\NewDocumentCommand{\xgroup}{D<>{}O{.}m}%
{%
    \begin{switch}{#2}%
        \xcase{} { \xenclose<#1>{.}{.}{#3} }             % default
        \xcase{.}{ \xenclose<#1>{.}{.}{#3} }             % default
        \xcase{p}{ \xenclose<#1>{(}{)}{#3} }             % parenthesis
        \xcase{b}{ \xenclose<#1>{[}{]}{#3} }             % brackets
        \xcase{B}{ \xenclose<#1>{\{}{\}}{#3} }           % braces
        \xcase{c}{ \xenclose<#1>{\langle}{\rangle}{#3} } % chevrons
        \xcase{v}{ \xenclose<#1>{\vert}{\vert}{#3} }     % absolute
        \xcase{V}{ \xenclose<#1>{\Vert}{\Vert}{#3} }     % normal
        \xcase{f}{ \xenclose<#1>{\lfloor}{\rfloor}{#3} } % floor
        \xcase{F}{ \xenclose<#1>{\lceil}{\rceil}{#3} }   % ceil
        \xcase{r}{ \xenclose<#1>{\lfloor}{\rceil}{#3} }  % round
    \end{switch}%
}%

% Interval Groups
\NewDocumentCommand{\xinterval}{D<>{}mm}%
{%
    \begin{switch}{#2}%
        \xcase{o} { \xenclose<#1>{(}{)}{#3} }%
        \xcase{c} { \xenclose<#1>{[}{]}{#3} }%
        \xcase{oo}{ \xenclose<#1>{(}{)}{#3} }%
        \xcase{cc}{ \xenclose<#1>{[}{]}{#3} }%
        \xcase{oc}{ \xenclose<#1>{(}{]}{#3} }%
        \xcase{co}{ \xenclose<#1>{[}{)}{#3} }%
    \end{switch}%
}%

% Named Enclosure Groups
\NewDocumentCommand{\xparen}{D<>{}m}{ \xgroup<#1>[p]{#2} }
\NewDocumentCommand{\xbrack}{D<>{}m}{ \xgroup<#1>[b]{#2} }
\NewDocumentCommand{\xbrace}{D<>{}m}{ \xgroup<#1>[B]{#2} }
\NewDocumentCommand{\xchevn}{D<>{}m}{ \xgroup<#1>[c]{#2} }
\NewDocumentCommand{\xabs}  {D<>{}m}{ \xgroup<#1>[v]{#2} }
\NewDocumentCommand{\xnorm} {D<>{}m}{ \xgroup<#1>[V]{#2} }
\NewDocumentCommand{\xfloor}{D<>{}m}{ \xgroup<#1>[f]{#2} }
\NewDocumentCommand{\xceil} {D<>{}m}{ \xgroup<#1>[F]{#2} }
\NewDocumentCommand{\xround}{D<>{}m}{ \xgroup<#1>[r]{#2} }

% Math Function
\NewDocumentCommand{\xf}{D<>{} e{_^}me{_^}}%
{%
    \ifel{\IfValueT{#2}{.}\IfValueT{#3}{.}}{}%
    {%
        {#4}%
    }{%
        \prescript%
            {\IfValueT{#3}{#3}}%
            {\IfValueT{#2}{#2}}%
        {#4}%
    }%
        \IfValueT{#5}{_{#5}}%
        \IfValueT{#6}{^{#6}}%
    \xfarg<#1>%
}%
\NewDocumentCommand{\xfarg}{D<>{} d<>O{p}ge{_^}}%
{%
    \IfValueT{#4}%
    {%
        \xgroup<\IfValueTF{#2}{#2}{#1}>[#3]{#4}%
            \IfValueT{#5}{_{#5}}%
            \IfValueT{#6}{^{#6}}%
        %
        \xfarg<#1>%     % recursive step
    }%
}%

% Math Vector
\usepackage[g]{esvect}
\NewDocumentCommand{\xv}{m}{ \vv{#1} }

% Math Matrix
\NewDocumentCommand{\xm}{O{p}m}{ \begin{#1matrix} #2 \end{#1matrix} }

% Partial Derivatives
\NewDocumentCommand{\pd}{O{}m}{\partial^{#1} #2}

% ------------------------------------------------------------------------------
%   Math Operators
% ------------------------------------------------------------------------------

\NewDocumentCommand{\xDeclareMathOperator}{mm}%
{%
    \expandafter\DeclareDocumentCommand\csname #1\endcsname{e{_^}D<>{}O{p}g}%
    {\ensuremath{%
        \operatorname{#2}%
            \IfValueT{##1}{_{##1}}%
            \IfValueT{##2}{^{##2}}%
        \IfValueT{##5}{\xgroup<##3>[##4]{##5}}%
    }}%
}%

\xDeclareMathOperator{Id}{\textnormal{Id}}          % identity

\xDeclareMathOperator{Set}{\textnormal{Set}}        % set
\xDeclareMathOperator{Grp}{\textnormal{Grp}}        % group
\xDeclareMathOperator{Rng}{\textnormal{Rng}}        % ring
\xDeclareMathOperator{Met}{\textnormal{Met}}        % metric

\xDeclareMathOperator{Mat}{\textnormal{Mat}}        % matrix
\xDeclareMathOperator{GL}{\textnormal{GL}}          % general linear group

\xDeclareMathOperator{Hom}{\textnormal{Hom}}        % homomorphism
\xDeclareMathOperator{Iso}{\textnormal{Iso}}        % isomorphism
\xDeclareMathOperator{Aut}{\textnormal{Aut}}        % automorphism
\xDeclareMathOperator{Mon}{\textnormal{Mon}}        % monomorphism
\xDeclareMathOperator{Epi}{\textnormal{Epi}}        % epimorphism

\xDeclareMathOperator{Obj}{\textnormal{Obj}}        % objects
\xDeclareMathOperator{Dom}{\textnormal{Dom}}        % domain
\xDeclareMathOperator{CoDom}{\textnormal{CoDom}}    % co-domain
\xDeclareMathOperator{Img}{\textnormal{Im}}         % image
\xDeclareMathOperator{Ker}{\textnormal{Ker}}        % kernel
\xDeclareMathOperator{Ann}{\textnormal{Ann}}        % annihilator
